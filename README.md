Based on the example at practicalswift.com

